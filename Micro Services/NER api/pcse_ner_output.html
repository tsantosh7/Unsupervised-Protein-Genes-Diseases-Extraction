<!DOCTYPE HTML>
<html>
<head>
<meta charset="UTF-8">
<script>

var chart = null;
var dataPoints = [];

window.onload = function() {

    chart = new CanvasJS.Chart("chartContainer", {
        animationEnabled: true,
        theme: "light2",
        title: {
            text: "Sentiment Analysis"
        },


        axisX:{
            valueFormatString: "DD MMM YYYY"
        },
        axisY: {
            title: "Polarity",
            includeZero: true,
            // scaleBreaks: {
            //     autoCalculate: true
            // },
            titleFontSize: 24
        },


        toolTip: {
            shared: true
        },
        legend: {
            cursor: "pointer",
            verticalAlign: "bottom",
            horizontalAlign: "left",
            dockInsidePlotArea: true,
            itemclick: toogleDataSeries
        },
        data: [{
            type: "line",
            xValueFormatString: "DD MMM YYYY",
            yValueFormatString: "##,###",
            dataPoints: dataPoints
        }]
    });


    $.getJSON("http://localhost:5200/twitter_sentiment_predictor?screen_name=mcdonalds&LLI=humanrights", callback);

}

function toogleDataSeries(e){
    if (typeof(e.dataSeries.visible) === "undefined" || e.dataSeries.visible) {
        e.dataSeries.visible = false;
    } else{
        e.dataSeries.visible = true;
    }
    chart.render();
}

function callback(data) {
	for (var i = 0; i < data.dps.length; i++) {

		// console.log(new Date(data.dps[i].created_at), data.dps[i].compound);
		dataPoints.push({
			x: new Date(data.dps[i].created_at),
			y: data.dps[i].compound
		});
	}
	chart.render();
}
</script>
</head>
<body>

<form action="localhost:5200/twitter_sentiment_predictor" method="get">
  <div>
    <label for="screen_name">Twitter Handle</label>
    <input name="screen_name" id="screen_name" value="mcdonalds">
  </div>
  <div>
    <label for="LLI">Who do you want to say it to?</label>
    <input name="LLI" id="LLI" value="humanrights">
  </div>
  <div>
    <button>Get Polarity</button>
  </div>
</form>


<div id="chartContainer" style="height: 370px; max-width: 920px; margin: 0px auto;"></div>
<script src="https://canvasjs.com/assets/script/jquery-1.11.1.min.js"></script>
<script src="canvasjs.min.js"></script>
</body>
</html>
